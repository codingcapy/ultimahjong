var I=Object.defineProperty;var R=r=>{throw TypeError(r)};var K=(r,e,t)=>e in r?I(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var w=(r,e,t)=>K(r,typeof e!="symbol"?e+"":e,t),N=(r,e,t)=>e.has(r)||R("Cannot "+t);var o=(r,e,t)=>(N(r,e,"read from private field"),t?t.call(r):e.get(r)),S=(r,e,t)=>e.has(r)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),j=(r,e,t,s)=>(N(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),C=(r,e,t)=>(N(r,e,"access private method"),t);import{S as W,s as z,h as L,g as B,n as _,r as x,a as Q,b as V,c as G,u as J,d as X,j as u,L as Y,D as Z}from"./index-BaD4k8_g.js";import{L as ee,a as te}from"./index-BVRnGBc_.js";var b,v,h,y,p,P,A,M,re=(M=class extends W{constructor(e,t){super();S(this,p);S(this,b);S(this,v);S(this,h);S(this,y);j(this,b,e),this.setOptions(t),this.bindMethods(),C(this,p,P).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var s;const t=this.options;this.options=o(this,b).defaultMutationOptions(e),z(this.options,t)||o(this,b).getMutationCache().notify({type:"observerOptionsUpdated",mutation:o(this,h),observer:this}),t!=null&&t.mutationKey&&this.options.mutationKey&&L(t.mutationKey)!==L(this.options.mutationKey)?this.reset():((s=o(this,h))==null?void 0:s.state.status)==="pending"&&o(this,h).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=o(this,h))==null||e.removeObserver(this)}onMutationUpdate(e){C(this,p,P).call(this),C(this,p,A).call(this,e)}getCurrentResult(){return o(this,v)}reset(){var e;(e=o(this,h))==null||e.removeObserver(this),j(this,h,void 0),C(this,p,P).call(this),C(this,p,A).call(this)}mutate(e,t){var s;return j(this,y,t),(s=o(this,h))==null||s.removeObserver(this),j(this,h,o(this,b).getMutationCache().build(o(this,b),this.options)),o(this,h).addObserver(this),o(this,h).execute(e)}},b=new WeakMap,v=new WeakMap,h=new WeakMap,y=new WeakMap,p=new WeakSet,P=function(){var t;const e=((t=o(this,h))==null?void 0:t.state)??B();j(this,v,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},A=function(e){_.batch(()=>{var t,s,i,n,d,c,m,l;if(o(this,y)&&this.hasListeners()){const a=o(this,v).variables,f=o(this,v).context;(e==null?void 0:e.type)==="success"?((s=(t=o(this,y)).onSuccess)==null||s.call(t,e.data,a,f),(n=(i=o(this,y)).onSettled)==null||n.call(i,e.data,null,a,f)):(e==null?void 0:e.type)==="error"&&((c=(d=o(this,y)).onError)==null||c.call(d,e.error,a,f),(l=(m=o(this,y)).onSettled)==null||l.call(m,void 0,e.error,a,f))}this.listeners.forEach(a=>{a(o(this,v))})})},M),se=x.createContext(void 0),$=r=>{const e=x.useContext(se);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e};function ie(r,e){const t=$(),[s]=x.useState(()=>new re(t,r));x.useEffect(()=>{s.setOptions(r)},[s,r]);const i=x.useSyncExternalStore(x.useCallback(d=>s.subscribe(_.batchCalls(d)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),n=x.useCallback((d,c)=>{s.mutate(d,c).catch(Q)},[s]);if(i.error&&V(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:n,mutateAsync:i.mutate}}const ae="/mjimg2.jpg";var ne=(r,e,t={})=>{let s=`${r}=${e}`;if(r.startsWith("__Secure-")&&!t.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(r.startsWith("__Host-")){if(!t.secure)throw new Error("__Host- Cookie must have Secure attributes");if(t.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(t.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(t&&typeof t.maxAge=="number"&&t.maxAge>=0){if(t.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");s+=`; Max-Age=${t.maxAge|0}`}if(t.domain&&t.prefix!=="host"&&(s+=`; Domain=${t.domain}`),t.path&&(s+=`; Path=${t.path}`),t.expires){if(t.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");s+=`; Expires=${t.expires.toUTCString()}`}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.sameSite&&(s+=`; SameSite=${t.sameSite.charAt(0).toUpperCase()+t.sameSite.slice(1)}`),t.priority&&(s+=`; Priority=${t.priority}`),t.partitioned){if(!t.secure)throw new Error("Partitioned Cookie must have Secure attributes");s+="; Partitioned"}return s},oe=(r,e,t)=>(e=encodeURIComponent(e),ne(r,e,t)),ce=(r,e)=>(r=r.replace(/\/+$/,""),r=r+"/",e=e.replace(/^\/+/,""),r+e),U=(r,e)=>{for(const[t,s]of Object.entries(e)){const i=new RegExp("/:"+t+"(?:{[^/]+})?\\??");r=r.replace(i,s?`/${s}`:"")}return r},T=r=>{const e=new URLSearchParams;for(const[t,s]of Object.entries(r))if(s!==void 0)if(Array.isArray(s))for(const i of s)e.append(t,i);else e.set(t,s);return e},ue=(r,e)=>{switch(e){case"ws":return r.replace(/^http/,"ws");case"http":return r.replace(/^ws/,"http")}},he=r=>/^https?:\/\/[^\/]+?\/index$/.test(r)?r.replace(/\/index$/,"/"):r.replace(/\/index$/,"");function k(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function D(r,e){if(!k(r)&&!k(e))return e;const t={...r};for(const s in e){const i=e[s];k(t[s])&&k(i)?t[s]=D(t[s],i):t[s]=i}return t}var H=(r,e)=>new Proxy(()=>{},{get(s,i){if(!(typeof i!="string"||i==="then"))return H(r,[...e,i])},apply(s,i,n){return r({path:e,args:n})}}),le=class{constructor(r,e){w(this,"url");w(this,"method");w(this,"queryParams");w(this,"pathParams",{});w(this,"rBody");w(this,"cType");w(this,"fetch",async(r,e)=>{if(r){if(r.query&&(this.queryParams=T(r.query)),r.form){const c=new FormData;for(const[m,l]of Object.entries(r.form))if(Array.isArray(l))for(const a of l)c.append(m,a);else c.append(m,l);this.rBody=c}r.json&&(this.rBody=JSON.stringify(r.json),this.cType="application/json"),r.param&&(this.pathParams=r.param)}let t=this.method.toUpperCase();const s={...r==null?void 0:r.header,...typeof(e==null?void 0:e.headers)=="function"?await e.headers():e==null?void 0:e.headers};if(r!=null&&r.cookie){const c=[];for(const[m,l]of Object.entries(r.cookie))c.push(oe(m,l,{path:"/"}));s.Cookie=c.join(",")}this.cType&&(s["Content-Type"]=this.cType);const i=new Headers(s);let n=this.url;n=he(n),n=U(n,this.pathParams),this.queryParams&&(n=n+"?"+this.queryParams.toString()),t=this.method.toUpperCase();const d=!(t==="GET"||t==="HEAD");return((e==null?void 0:e.fetch)||fetch)(n,{body:d?this.rBody:void 0,method:t,headers:i,...e==null?void 0:e.init})});this.url=r,this.method=e}},de=(r,e)=>H(function t(s){var l;const i=[...s.path];if(i.at(-1)==="toString")return i.at(-2)==="name"?i.at(-3)||"":t.toString();if(i.at(-1)==="valueOf")return i.at(-2)==="name"?i.at(-3)||"":t;let n="";if(/^\$/.test(i.at(-1))){const a=i.pop();a&&(n=a.replace(/^\$/,""))}const d=i.join("/"),c=ce(r,d);if(n==="url"){let a=c;return s.args[0]&&(s.args[0].param&&(a=U(c,s.args[0].param)),s.args[0].query&&(a=a+"?"+T(s.args[0].query).toString())),new URL(a)}if(n==="ws"){const a=ue(s.args[0]&&s.args[0].param?U(c,s.args[0].param):c,"ws"),f=new URL(a),g=(l=s.args[0])==null?void 0:l.query;return g&&Object.entries(g).forEach(([E,O])=>{Array.isArray(O)?O.forEach(F=>f.searchParams.append(E,F)):f.searchParams.set(E,O)}),((...E)=>(e==null?void 0:e.webSocket)!==void 0&&typeof e.webSocket=="function"?e.webSocket(...E):new WebSocket(...E))(f.toString())}const m=new le(c,n);if(n){e??(e={});const a=D(e,{...s.args[1]});return m.fetch(s.args[0],a)}return m},[]);const me="https://ultimahjong-production-3fbe.up.railway.app/",fe=de(me);function ye(r){return{...r,createdAt:new Date(r.createdAt)}}async function xe(r){const e=await fe.api.users.$post({json:r});if(!e.ok){let s="There was an issue creating your account :( We'll look into it ASAP!";try{const i=await e.json();i&&typeof i=="object"&&"message"in i&&(s=String(i.message))}catch(i){console.error("Failed to parse error response:",i)}throw new Error(s)}const t=await e.json();if(!t.user)throw new Error("Invalid response from server");return ye(t.user)}const pe=r=>{const e=$();return ie({mutationFn:xe,onSettled:t=>{if(!t)return console.log(t,"create args, returning");e.invalidateQueries({queryKey:["users"]})},onError:t=>{}})},Se=G("/register")({component:we});function we(){J();const[r,e]=x.useState(""),{loginService:t,authLoading:s,user:i}=X(a=>a),[n,d]=x.useState(!1),{mutate:c}=pe();async function m(a){a.preventDefault(),console.log(Z);const f=a.target.email.value,g=a.target.password.value;console.log(f,g),c({email:f,password:g},{onSuccess:()=>{t(f,g),s&&e("Loading...")},onError:q=>e(q.toString())})}function l(){d(!n)}return u.jsx("main",{className:"flex-1",children:u.jsxs("div",{className:"md:flex",children:[u.jsxs("div",{className:"md:w-[30%] flex flex-col mx-auto ",children:[u.jsx("h1",{className:"pt-5 text-lg mx-auto text-center md:pt-20 font-bold z-10 text-white md:text-black",children:"Create an account"}),u.jsxs("form",{onSubmit:m,className:"flex flex-col mx-auto z-10 w-[300px]",children:[u.jsx("label",{htmlFor:"",className:"text-white md:text-black",children:"Email"}),u.jsx("input",{className:"border",type:"email",id:"email",name:"email",required:!0}),u.jsx("label",{htmlFor:"Password",className:"text-white md:text-black",children:"Password"}),u.jsxs("div",{className:"flex border relative",children:[u.jsx("input",{className:"w-[100%]",type:n?"text":"password",id:"password",name:"password",required:!0}),u.jsx("button",{type:"button",onClick:l,className:"absolute right-2 top-1 text-gray-400",children:n?u.jsx(ee,{className:""}):u.jsx(te,{className:""})})]}),u.jsx("button",{className:"bg-green-800 text-white mt-10 px-10 py-2",children:"Register"})]}),u.jsxs("div",{className:" mt-20 text-center text-gray-500",children:["Already have an account?",u.jsx(Y,{to:"/",className:"font-bold pl-2 text-black",children:"Login"})]})]}),u.jsxs("div",{className:"md:w-[70%] absolute top-0 left-0 md:relative",children:[u.jsx("div",{className:"md:hidden fixed m-2 top-0 left-0 w-[96%] h-[257px] rounded-2xl bg-black opacity-50"}),u.jsx("img",{src:ae,alt:"",className:"w-[100%] p-2 rounded-2xl"})]})]})})}export{Se as Route};
