var B=Object.defineProperty;var R=t=>{throw TypeError(t)};var I=(t,e,r)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var x=(t,e,r)=>I(t,typeof e!="symbol"?e+"":e,r),N=(t,e,r)=>e.has(t)||R("Cannot "+r);var c=(t,e,r)=>(N(t,e,"read from private field"),r?r.call(t):e.get(t)),S=(t,e,r)=>e.has(t)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),j=(t,e,r,s)=>(N(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),C=(t,e,r)=>(N(t,e,"access private method"),r);import{r as b,c as K,u as Q,a as W,j as l,L as J,D as V}from"./index-Dff5il7b.js";import{L as G,a as X}from"./index-BUh_AV-h.js";const Y="/mjimg2.jpg";var Z=(t,e,r={})=>{let s=`${t}=${e}`;if(t.startsWith("__Secure-")&&!r.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(t.startsWith("__Host-")){if(!r.secure)throw new Error("__Host- Cookie must have Secure attributes");if(r.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(r.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(r&&typeof r.maxAge=="number"&&r.maxAge>=0){if(r.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");s+=`; Max-Age=${r.maxAge|0}`}if(r.domain&&r.prefix!=="host"&&(s+=`; Domain=${r.domain}`),r.path&&(s+=`; Path=${r.path}`),r.expires){if(r.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");s+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite&&(s+=`; SameSite=${r.sameSite.charAt(0).toUpperCase()+r.sameSite.slice(1)}`),r.priority&&(s+=`; Priority=${r.priority}`),r.partitioned){if(!r.secure)throw new Error("Partitioned Cookie must have Secure attributes");s+="; Partitioned"}return s},ee=(t,e,r)=>(e=encodeURIComponent(e),Z(t,e,r)),te=(t,e)=>(t=t.replace(/\/+$/,""),t=t+"/",e=e.replace(/^\/+/,""),t+e),A=(t,e)=>{for(const[r,s]of Object.entries(e)){const i=new RegExp("/:"+r+"(?:{[^/]+})?\\??");t=t.replace(i,s?`/${s}`:"")}return t},$=t=>{const e=new URLSearchParams;for(const[r,s]of Object.entries(t))if(s!==void 0)if(Array.isArray(s))for(const i of s)e.append(r,i);else e.set(r,s);return e},re=(t,e)=>{switch(e){case"ws":return t.replace(/^http/,"ws");case"http":return t.replace(/^ws/,"http")}},se=t=>/^https?:\/\/[^\/]+?\/index$/.test(t)?t.replace(/\/index$/,"/"):t.replace(/\/index$/,"");function P(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function T(t,e){if(!P(t)&&!P(e))return e;const r={...t};for(const s in e){const i=e[s];P(r[s])&&P(i)?r[s]=T(r[s],i):r[s]=i}return r}var D=(t,e)=>new Proxy(()=>{},{get(s,i){if(!(typeof i!="string"||i==="then"))return D(t,[...e,i])},apply(s,i,a){return t({path:e,args:a})}}),ie=class{constructor(t,e){x(this,"url");x(this,"method");x(this,"queryParams");x(this,"pathParams",{});x(this,"rBody");x(this,"cType");x(this,"fetch",async(t,e)=>{if(t){if(t.query&&(this.queryParams=$(t.query)),t.form){const n=new FormData;for(const[u,d]of Object.entries(t.form))if(Array.isArray(d))for(const o of d)n.append(u,o);else n.append(u,d);this.rBody=n}t.json&&(this.rBody=JSON.stringify(t.json),this.cType="application/json"),t.param&&(this.pathParams=t.param)}let r=this.method.toUpperCase();const s={...t==null?void 0:t.header,...typeof(e==null?void 0:e.headers)=="function"?await e.headers():e==null?void 0:e.headers};if(t!=null&&t.cookie){const n=[];for(const[u,d]of Object.entries(t.cookie))n.push(ee(u,d,{path:"/"}));s.Cookie=n.join(",")}this.cType&&(s["Content-Type"]=this.cType);const i=new Headers(s);let a=this.url;a=se(a),a=A(a,this.pathParams),this.queryParams&&(a=a+"?"+this.queryParams.toString()),r=this.method.toUpperCase();const h=!(r==="GET"||r==="HEAD");return((e==null?void 0:e.fetch)||fetch)(a,{body:h?this.rBody:void 0,method:r,headers:i,...e==null?void 0:e.init})});this.url=t,this.method=e}},ne=(t,e)=>D(function r(s){var d;const i=[...s.path];if(i.at(-1)==="toString")return i.at(-2)==="name"?i.at(-3)||"":r.toString();if(i.at(-1)==="valueOf")return i.at(-2)==="name"?i.at(-3)||"":r;let a="";if(/^\$/.test(i.at(-1))){const o=i.pop();o&&(a=o.replace(/^\$/,""))}const h=i.join("/"),n=te(t,h);if(a==="url"){let o=n;return s.args[0]&&(s.args[0].param&&(o=A(n,s.args[0].param)),s.args[0].query&&(o=o+"?"+$(s.args[0].query).toString())),new URL(o)}if(a==="ws"){const o=re(s.args[0]&&s.args[0].param?A(n,s.args[0].param):n,"ws"),m=new URL(o),g=(d=s.args[0])==null?void 0:d.query;return g&&Object.entries(g).forEach(([O,E])=>{Array.isArray(E)?E.forEach(z=>m.searchParams.append(O,z)):m.searchParams.set(O,E)}),((...O)=>(e==null?void 0:e.webSocket)!==void 0&&typeof e.webSocket=="function"?e.webSocket(...O):new WebSocket(...O))(m.toString())}const u=new ie(n,a);if(a){e??(e={});const o=T(e,{...s.args[1]});return u.fetch(s.args[0],o)}return u},[]);const ae="https://ultimahjong-production-3fbe.up.railway.app/",oe=ne(ae);var ce=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}};function ue(){}function L(t){return JSON.stringify(t,(e,r)=>he(r)?Object.keys(r).sort().reduce((s,i)=>(s[i]=r[i],s),{}):r)}function le(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function he(t){if(!M(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!M(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function M(t){return Object.prototype.toString.call(t)==="[object Object]"}function fe(t,e){return typeof t=="function"?t(...e):!!t}var de=t=>setTimeout(t,0);function me(){let t=[],e=0,r=n=>{n()},s=n=>{n()},i=de;const a=n=>{e?t.push(n):i(()=>{r(n)})},h=()=>{const n=t;t=[],n.length&&i(()=>{s(()=>{n.forEach(u=>{r(u)})})})};return{batch:n=>{let u;e++;try{u=n()}finally{e--,e||h()}return u},batchCalls:n=>(...u)=>{a(()=>{n(...u)})},schedule:a,setNotifyFunction:n=>{r=n},setBatchNotifyFunction:n=>{s=n},setScheduler:n=>{i=n}}}var F=me();function ye(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var w,v,f,y,p,k,U,_,be=(_=class extends ce{constructor(e,r){super();S(this,p);S(this,w);S(this,v);S(this,f);S(this,y);j(this,w,e),this.setOptions(r),this.bindMethods(),C(this,p,k).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var s;const r=this.options;this.options=c(this,w).defaultMutationOptions(e),le(this.options,r)||c(this,w).getMutationCache().notify({type:"observerOptionsUpdated",mutation:c(this,f),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&L(r.mutationKey)!==L(this.options.mutationKey)?this.reset():((s=c(this,f))==null?void 0:s.state.status)==="pending"&&c(this,f).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=c(this,f))==null||e.removeObserver(this)}onMutationUpdate(e){C(this,p,k).call(this),C(this,p,U).call(this,e)}getCurrentResult(){return c(this,v)}reset(){var e;(e=c(this,f))==null||e.removeObserver(this),j(this,f,void 0),C(this,p,k).call(this),C(this,p,U).call(this)}mutate(e,r){var s;return j(this,y,r),(s=c(this,f))==null||s.removeObserver(this),j(this,f,c(this,w).getMutationCache().build(c(this,w),this.options)),c(this,f).addObserver(this),c(this,f).execute(e)}},w=new WeakMap,v=new WeakMap,f=new WeakMap,y=new WeakMap,p=new WeakSet,k=function(){var r;const e=((r=c(this,f))==null?void 0:r.state)??ye();j(this,v,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},U=function(e){F.batch(()=>{var r,s,i,a,h,n,u,d;if(c(this,y)&&this.hasListeners()){const o=c(this,v).variables,m=c(this,v).context;(e==null?void 0:e.type)==="success"?((s=(r=c(this,y)).onSuccess)==null||s.call(r,e.data,o,m),(a=(i=c(this,y)).onSettled)==null||a.call(i,e.data,null,o,m)):(e==null?void 0:e.type)==="error"&&((n=(h=c(this,y)).onError)==null||n.call(h,e.error,o,m),(d=(u=c(this,y)).onSettled)==null||d.call(u,void 0,e.error,o,m))}this.listeners.forEach(o=>{o(c(this,v))})})},_),pe=b.createContext(void 0),H=t=>{const e=b.useContext(pe);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e};function xe(t,e){const r=H(),[s]=b.useState(()=>new be(r,t));b.useEffect(()=>{s.setOptions(t)},[s,t]);const i=b.useSyncExternalStore(b.useCallback(h=>s.subscribe(F.batchCalls(h)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),a=b.useCallback((h,n)=>{s.mutate(h,n).catch(ue)},[s]);if(i.error&&fe(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}function we(t){return{...t,createdAt:new Date(t.createdAt)}}async function ve(t){const e=await oe.api.users.$post({json:t});if(!e.ok){let s="There was an issue creating your account :( We'll look into it ASAP!";try{const i=await e.json();i&&typeof i=="object"&&"message"in i&&(s=String(i.message))}catch(i){console.error("Failed to parse error response:",i)}throw new Error(s)}const r=await e.json();if(!r.user)throw new Error("Invalid response from server");return we(r.user)}const ge=t=>{const e=H();return xe({mutationFn:ve,onSettled:r=>{if(!r)return console.log(r,"create args, returning");e.invalidateQueries({queryKey:["users"]})},onError:r=>{}})},Pe=K("/register")({component:Se});function Se(){Q();const[t,e]=b.useState(""),{loginService:r,authLoading:s,user:i}=W(o=>o),[a,h]=b.useState(!1),{mutate:n}=ge();async function u(o){o.preventDefault(),console.log(V);const m=o.target.email.value,g=o.target.password.value;console.log(m,g),n({email:m,password:g},{onSuccess:()=>{r(m,g),s&&e("Loading...")},onError:q=>e(q.toString())})}function d(){h(!a)}return l.jsx("main",{className:"flex-1",children:l.jsxs("div",{className:"md:flex",children:[l.jsxs("div",{className:"md:w-[30%] flex flex-col mx-auto ",children:[l.jsx("h1",{className:"pt-5 text-lg mx-auto text-center md:pt-20 font-bold z-10 text-white md:text-black",children:"Create an account"}),l.jsxs("form",{onSubmit:u,className:"flex flex-col mx-auto z-10 w-[300px]",children:[l.jsx("label",{htmlFor:"",className:"text-white md:text-black",children:"Email"}),l.jsx("input",{className:"border",type:"email",id:"email",name:"email",required:!0}),l.jsx("label",{htmlFor:"Password",className:"text-white md:text-black",children:"Password"}),l.jsxs("div",{className:"flex border relative",children:[l.jsx("input",{className:"w-[100%]",type:a?"text":"password",id:"password",name:"password",required:!0}),l.jsx("button",{type:"button",onClick:d,className:"absolute right-2 top-1 text-gray-400",children:a?l.jsx(G,{className:""}):l.jsx(X,{className:""})})]}),l.jsx("button",{className:"bg-green-800 text-white mt-10 px-10 py-2",children:"Register"})]}),l.jsxs("div",{className:" mt-20 text-center text-gray-500",children:["Already have an account?",l.jsx(J,{to:"/",className:"font-bold pl-2 text-black",children:"Login"})]})]}),l.jsxs("div",{className:"md:w-[70%] absolute top-0 left-0 md:relative",children:[l.jsx("div",{className:"md:hidden fixed m-2 top-0 left-0 w-[96%] h-[257px] rounded-2xl bg-black opacity-50"}),l.jsx("img",{src:Y,alt:"",className:"w-[100%] p-2 rounded-2xl"})]})]})})}export{Pe as Route};
