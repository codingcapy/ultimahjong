import{u as G,a as C,j as e,L as E,b as u,D as x,r as i,c as D}from"./index-CTJ2RkRH.js";import{u as v,I,T as L}from"./TopNav-DHXQ_9qn.js";import{b as _}from"./index-BqU0wFYE.js";function T(){const s=G(),{logoutService:n,authLoading:c,user:h}=C(a=>a),{games:l,setGames:d}=v(a=>a);function t(){n(),s({to:"/"})}async function m(a){var o;a.preventDefault();try{const N={year:"New Game"};if((o=(await u.post(`${x}/api/games`,N)).data)!=null&&o.success){const j=await u.get(`${x}/api/games`),p=[];j.data.forEach(w=>p.push(w)),d([...p])}else throw new Error("Project ID not found in response")}catch(g){console.log(g)}}return e.jsxs("div",{className:"hidden w-[12%] h-screen bg-black text-white md:flex flex-col justify-between",children:[e.jsxs("div",{className:"pt-10 text-center",children:[e.jsx(E,{to:"/",className:"pt-10 text-center font-bold",children:"Ultimate MahJong"}),e.jsx("form",{onSubmit:m,children:e.jsx("button",{className:"m-10 py-2 px-5 bg-green-500 rounded",children:"New Game"})})]}),e.jsxs("div",{className:"flex p-10 pb-20 cursor-pointer",onClick:t,children:[e.jsx(I,{className:" py-1 w-[25px] h-[25px]"}),e.jsx("div",{className:"pl-2 py-0",children:"Logout"})]})]})}function $(s){const[n,c]=i.useState(window.innerWidth<500),[h,l]=i.useState(!1),[d,t]=i.useState(!1),[m,a]=i.useState(!1),[o,g]=i.useState(s.game.year),{games:N,setGames:b,currentGameId:j,setCurrentGameId:p}=v(r=>r);function w(){l(!h)}async function S(r){r.preventDefault();const M=r.target.title.value;try{await u.patch(`${x}/api/games/${s.game.game_id}`,{year:M});const f=await u.get(`${x}/api/games`),y=[];console.log(f.data),f.data.forEach(k=>y.push(k)),b([...y]),t(!1),l(!1)}catch(f){console.error("Error updating project title:",f)}}return e.jsxs("div",{className:"relative",onClick:()=>{p(s.game.game_id),console.log(s.game.game_id),console.log(j)},onMouseEnter:()=>window.innerWidth>500&&c(!0),onMouseLeave:()=>{window.innerWidth>500&&c(!1),window.innerWidth>500&&l(!1)},children:[e.jsx(E,{to:"/record",children:e.jsx("div",{className:"py-10 bg-gray-600 text-center text-white my-2 md:my-0",children:s.game.year},s.game.game_id)}),n&&e.jsx("div",{className:"absolute right-0 top-0 p-3 cursor-pointer z-10",onClick:w,children:e.jsx(_,{})}),h&&e.jsxs("div",{className:"absolute right-5 top-10 bg-[#242424] border border-[#373541] rounded-xl py-5 px-5 z-10",children:[e.jsx("div",{className:"pb-1 cursor-pointer",onClick:()=>t(!0),children:"Edit Game Name"}),d&&e.jsx("div",{children:e.jsxs("form",{onSubmit:S,className:"flex flex-col",children:[e.jsx("input",{name:"title",id:"title",type:"text",value:o,onChange:r=>g(r.target.value),className:"bg-transparent border border-[#373541] px-1"}),e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"pr-2",children:"Update"}),e.jsx("button",{className:"px-2",onClick:()=>t(!1),children:"Cancel"})]})]})}),e.jsx("div",{className:"flex my-2",children:e.jsx("div",{className:"pl-2 text-[#D2B1FC] cursor-pointer",onClick:()=>a(!0),children:"Delete"})})]})]},s.game.game_id)}const U=D("/dashboard")({component:R});function R(){const{user:s}=C(t=>t),{games:n,setGames:c,currentGameId:h,setCurrentGameId:l}=v(t=>t),d=G();return i.useEffect(()=>{s||d({to:"/"});async function t(){const m=await u.get(`${x}/api/games`),a=[];console.log(m.data),m.data.forEach(o=>a.push(o)),c([...a])}t()},[]),e.jsxs("main",{className:"flex-1 text-white",children:[e.jsx(L,{}),e.jsxs("div",{className:"flex",children:[e.jsx(T,{}),e.jsx("div",{className:"w-[100%] bg-gray-700 h-screen p-10",children:e.jsx("div",{className:"md:grid grid-cols-5 gap-3",children:n&&n.map(t=>e.jsx($,{game:t},t.game_id))})})]})]})}export{U as Route};
