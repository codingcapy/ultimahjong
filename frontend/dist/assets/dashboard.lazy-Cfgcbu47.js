import{u as G,a as C,j as e,L as k,b as i,D as l,r as x,c as L}from"./index-Dff5il7b.js";import{u as y,I as A,T as $}from"./TopNav-BUKSTqdb.js";import{b as I}from"./index-BUh_AV-h.js";function T(){const a=G(),{logoutService:c,authLoading:h,user:p}=C(s=>s),{games:d,setGames:g}=y(s=>s);function t(){c(),a({to:"/"})}async function o(s){var m;s.preventDefault();try{const E={year:"New Game"};if((m=(await i.post(`${l}/api/games`,E)).data)!=null&&m.success){const w=await i.get(`${l}/api/games`),j=[];w.data.forEach(N=>j.push(N)),g([...j])}else throw new Error("Project ID not found in response")}catch(f){console.log(f)}}return e.jsxs("div",{className:"hidden w-[12%] h-screen bg-black text-white md:flex flex-col justify-between",children:[e.jsxs("div",{className:"pt-10 text-center",children:[e.jsx(k,{to:"/",className:"pt-10 text-center font-bold",children:"Ultimate MahJong"}),e.jsx("form",{onSubmit:o,children:e.jsx("button",{className:"m-10 py-2 px-5 bg-green-500 rounded",children:"New Game"})})]}),e.jsxs("div",{className:"flex p-10 pb-20 cursor-pointer",onClick:t,children:[e.jsx(A,{className:" py-1 w-[25px] h-[25px]"}),e.jsx("div",{className:"pl-2 py-0",children:"Logout"})]})]})}function _(a){const[c,h]=x.useState(window.innerWidth<500),[p,d]=x.useState(!1),[g,t]=x.useState(!1),[o,s]=x.useState(!1),[m,f]=x.useState(a.game.year),{games:E,setGames:v,currentGameId:w,setCurrentGameId:j}=y(n=>n);function N(){d(!p)}async function D(n){n.preventDefault();const u=n.target.title.value;try{await i.patch(`${l}/api/games/${a.game.game_id}`,{year:u});const r=await i.get(`${l}/api/games`),b=[];console.log(r.data),r.data.forEach(M=>b.push(M)),v([...b]),t(!1),d(!1)}catch(r){console.error("Error updating project title:",r)}}async function S(n){n.preventDefault();try{await i.post(`${l}/api/games/${a.game.game_id}`);const u=await i.get(`${l}/api/games`),r=[];console.log(u.data),u.data.forEach(b=>r.push(b)),v([...r]),t(!1),d(!1)}catch(u){console.error("Error deleting project:",u)}}return e.jsxs("div",{className:"relative",onClick:()=>{j(a.game.game_id),console.log(a.game.game_id),console.log(w)},onMouseEnter:()=>window.innerWidth>500&&h(!0),onMouseLeave:()=>{window.innerWidth>500&&h(!1),window.innerWidth>500&&d(!1)},children:[o&&e.jsxs("div",{className:"fixed z-[201] py-5 px-2 md:px-5 rounded-lg bg-[#1A1A1A] top-[20%] md:top-[10%] left-[5%] md:left-[35%] flex flex-col w-[90%]",children:[e.jsx("div",{className:"text-xl py-5 font-bold ",children:"Delete For Eternity"}),e.jsxs("div",{className:"",children:["You are about to permanently delete"," ",e.jsx("span",{className:"text-[#D2B1FD]",children:a.game.year}),". This ",e.jsx("br",{})," game will be gone forever."]}),e.jsx("div",{className:"mx-auto py-2",children:e.jsxs("form",{onSubmit:S,children:[e.jsx("input",{name:"content",id:"content",defaultValue:"[this message was deleted]",className:"hidden"}),e.jsxs("div",{className:"flex md:pl-64",children:[e.jsx("button",{className:"md:block md:pb-1 edit-btn cursor-pointer px-5 py-2 md:my-2 mx-2 bg-[#BABABA] rounded hover:bg-[#fafafa] transition-all ease duration-300 text-black tracking-widest",onClick:()=>s(!1),children:"CANCEL"}),e.jsx("button",{className:"md:block delete-btn cursor-pointer px-5 py-2 md:my-2 bg-[#DD4B63] rounded hover:bg-red-600 transition-all ease duration-300 tracking-widest",children:"DELETE"})]})]})})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-black z-[200] opacity-70",onClick:()=>s(!1)}),e.jsx(k,{to:"/record",children:e.jsx("div",{className:"py-10 bg-gray-600 text-center text-white my-2 md:my-0",children:a.game.year},a.game.game_id)}),c&&e.jsx("div",{className:"absolute right-0 top-0 p-3 cursor-pointer z-10",onClick:N,children:e.jsx(I,{})}),p&&e.jsxs("div",{className:"absolute right-5 top-10 bg-[#242424] border border-[#373541] rounded-xl py-5 px-5 z-10",children:[e.jsx("div",{className:"pb-1 cursor-pointer",onClick:()=>t(!0),children:"Edit Game Name"}),g&&e.jsx("div",{children:e.jsxs("form",{onSubmit:D,className:"flex flex-col",children:[e.jsx("input",{name:"title",id:"title",type:"text",value:m,onChange:n=>f(n.target.value),className:"bg-transparent border border-[#373541] px-1"}),e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"pr-2",children:"Update"}),e.jsx("button",{className:"px-2",onClick:()=>t(!1),children:"Cancel"})]})]})}),e.jsx("div",{className:"flex my-2",children:e.jsx("div",{className:"text-[#D2B1FC] cursor-pointer",onClick:()=>s(!0),children:"Delete"})})]})]},a.game.game_id)}const W=L("/dashboard")({component:B});function B(){const{user:a}=C(t=>t),{games:c,setGames:h,currentGameId:p,setCurrentGameId:d}=y(t=>t),g=G();return x.useEffect(()=>{a||g({to:"/"});async function t(){const o=await i.get(`${l}/api/games`),s=[];console.log(o.data),o.data.forEach(m=>s.push(m)),h([...s])}t()},[]),e.jsxs("main",{className:"flex-1 text-white",children:[e.jsx($,{}),e.jsxs("div",{className:"flex",children:[e.jsx(T,{}),e.jsx("div",{className:"w-[100%] bg-gray-700 h-screen p-10",children:e.jsx("div",{className:"md:grid grid-cols-5 gap-3",children:c&&c.map(t=>t.active&&e.jsx(_,{game:t},t.game_id))})})]})]})}export{W as Route};
